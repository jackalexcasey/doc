#
# get lpj per-cpu
#
sudo insmod bogomips.ko

# 
# Place the executing on the apropriate CPU
#
bash
taskset -pc 'cpu' 'pid of bash'
chrt -p -r 'prio' 'pid'

# 
# From the dmesg per cpu lpj table run user space and kernel space
#
# [ 8908.370689] PER CPU lpj info
# [ 8908.370696] CPU 0 : lpj 6383772
# [ 8908.370700] CPU 1 : lpj 6383358
# [ 8908.370703] CPU 2 : lpj 6383361
# [ 8908.370706] CPU 3 : lpj 6383353
#
# lpj information gives us the amount of TSC cycle in a jiffie period
# It doesn't not give the auto-calibrate loop number value.
#


rmmod bogomips
dmesg -c >/dev/null
insmod bogomips.ko l=1000 j=100000

./bogomips -l 1000 -j 100000 -c1
./bogomips -l 10000 -j 100000 -c1 -k

# NOTES:
# Current execution is done on kworker thread ... -< because of the insmod thing
# http://www.thinkwiki.org/wiki/How_to_make_use_of_Dynamic_Frequency_Scaling

#
# Disable hyper -threading and dynamic PWR mgmt
# Turn off the watchdog thread.
#
cd /proc/sys/kernel
echo 0 >watchdog
